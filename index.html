<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Francisco Herrera Music | Official Website</title>
    <meta name="description" content="Official website of Francisco Herrera - Hip-hop artist and musician. Listen to the latest tracks, watch videos, and stay updated with tour dates." />
    
    <!-- Open Graph / Social Media Meta Tags -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://franciscoherreramusic.com" />
    <meta property="og:title" content="Francisco Herrera Music | Official Website" />
    <meta property="og:description" content="Official website of Francisco Herrera - Hip-hop artist and musician. Listen to the latest tracks, watch videos, and stay updated with tour dates." />
    <meta property="og:image" content="https://pub-e51e6a830d3346cea7ea8a85a6b8d942.r2.dev/FSTUDIOSH.png" />

    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Francisco Herrera Music | Official Website" />
    <meta name="twitter:description" content="Official website of Francisco Herrera - Hip-hop artist and musician. Listen to the latest tracks, watch videos, and stay updated with tour dates." />
    <meta name="twitter:image" content="https://pub-e51e6a830d3346cea7ea8a85a6b8d942.r2.dev/FSTUDIOSH.png" />
    
    <!-- ContentTools CSS -->
    <link rel="stylesheet" href="https://unpkg.com/contenttools@1.6.12/build/content-tools.min.css">
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
    
    <!-- ContentTools JS (at the end of body for better performance) -->
    <script src="https://unpkg.com/contenttools@1.6.12/build/content-tools.min.js"></script>
    
    <!-- Simple editor initialization -->
    <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Check for edit token
      const params = new URLSearchParams(window.location.search);
      const token = params.get('token');
      
      if (token) {
        // Store token in localStorage
        localStorage.setItem('editToken', token);
        console.log('Edit token found and stored');
      }
      
      // Initialize editor if we have a token
      const hasToken = token || localStorage.getItem('editToken');
      
      if (hasToken) {
        console.log('Initializing ContentTools...');
        
        // Function to make elements editable
        function makeEditable() {
          console.log('Making elements editable...');
          const selectors = ['h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'p', 'li'];
          
          selectors.forEach(selector => {
            document.querySelectorAll(selector).forEach((el, i) => {
              if (!el.closest('a, button') && !el.hasAttribute('data-editable')) {
                el.setAttribute('data-editable', '');
                el.setAttribute('data-name', `text-${selector}-${i}`);
                console.log(`Made editable: ${selector} #${i}`);
              }
            });
          });
          
          // Make images editable
          document.querySelectorAll('img').forEach((img, i) => {
            if (!img.hasAttribute('data-editable')) {
              img.setAttribute('data-editable', '');
              img.setAttribute('data-name', `image-${i}`);
            }
          });
        }
        
        // Make elements editable on load and whenever URL changes
        makeEditable();
        
        // Setup URL change detection
        let lastPathname = location.pathname;
        setInterval(() => {
          if (location.pathname !== lastPathname) {
            lastPathname = location.pathname;
            console.log('URL changed, updating editable elements');
            
            // Wait for React to render the new page
            setTimeout(makeEditable, 500);
          }
        }, 300);
        
        // Initialize ContentTools
        try {
          if (window.ContentTools) {
            console.log('ContentTools found, initializing editor');
            const editor = ContentTools.EditorApp.get();
            editor.init('*[data-editable]', 'data-name');
            
            // Simple save handler (demo mode)
            editor.addEventListener('saved', function(ev) {
              const regions = ev.detail().regions;
              console.log('Content saved (demo mode):', regions);
            });
            
            console.log('ContentTools editor initialized successfully');
          } else {
            console.error('ContentTools library not found. Check if it loaded properly.');
          }
        } catch (error) {
          console.error('Error initializing ContentTools:', error);
        }
      } else {
        console.log('No edit token found. Add ?token=abc to the URL to enable editing mode.');
      }
    });
    </script>
  </body>
</html>
